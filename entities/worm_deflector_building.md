---
title: Worm Deflector Building
category: entities
---

# Worm Deflector Building

This entity defines a building that repels worms. It has physics properties, takes damage, and explodes when destroyed. It also emits particles and has a light source.

## Key Components

### Base Physics (`Base file="data/entities/base_item_physics.xml"`)

This component provides the fundamental physics properties for the entity.

*   **`PhysicsBodyComponent`**:
    *   `on_death_leave_physics_body`: Set to `1`, meaning the physics body will remain after the entity is destroyed.
*   **`PhysicsImageShapeComponent`**:
    *   `image_file`: Specifies the visual representation of the deflector (`data/props_gfx/worm_deflector.png`).
    *   `material`: Sets the material to `metal_prop`.

### Damage (`DamageModelComponent`)

Defines how the entity reacts to damage.

*   **Health and Damage**:
    *   `hp`: `10.2` - The total health of the deflector.
    *   `falling_damage_damage_max`: `1.2` - Maximum damage from falling.
    *   `falling_damage_damage_min`: `0.1` - Minimum damage from falling.
    *   `falling_damage_height_max`: `250` - Maximum height for falling damage calculation.
    *   `falling_damage_height_min`: `70` - Minimum height for falling damage calculation.
    *   `fire_damage_amount`: `0.4` - Damage taken from fire.
*   **Material Interaction**:
    *   `materials_that_damage`: `fire,lava,acid` - Materials that can damage the deflector.
    *   `materials_how_much_damage`: `0.0002,0.0001,0.001` - The amount of damage dealt by each material in the `materials_that_damage` list.
*   **Resistances**:
    *   `critical_damage_resistance`: `1` - Indicates high resistance to critical damage.
*   **Damage Multipliers**:
    *   `melee`: `0.1` - Reduces melee damage taken by 90%.

### Explosion (`ExplodeOnDamageComponent`)

Determines the explosion behavior when the deflector is destroyed.

*   **Explosion Triggering**:
    *   `explode_on_death_percent`: `1` - The deflector will explode upon death.
    *   `physics_body_modified_death_probability`: `0.9` - If the physics body is sufficiently damaged (see `physics_body_destruction_required`), there's a 90% chance of an explosion.
    *   `physics_body_destruction_required`: `0.3` - The deflector needs to be at least 30% destroyed physically to trigger the explosion probability.
*   **Explosion Configuration (`config_explosion`)**:
    *   `damage`: `0` - The explosion itself does no direct damage to entities.
    *   `camera_shake`: `40` - The intensity of camera shake during the explosion.
    *   `explosion_radius`: `20` - The radius of the explosion effect.
    *   `load_this_entity`: `data/entities/particles/particle_explosion/main.xml` - The entity to load for the explosion effect.
    *   `hole_enabled`: `1` - Creates a hole in the environment where the explosion occurs.
    *   `ray_energy`: `30000` - Energy of the explosion's rays.
    *   `physics_explosion_power.min`: `1.9` - Minimum physics force applied by the explosion.
    *   `physics_explosion_power.max`: `2.5` - Maximum physics force applied by the explosion.
    *   `physics_throw_enabled`: `1` - Objects affected by the explosion will be thrown.
    *   `sparks_enabled`: `1` - Sparks are generated by the explosion.
    *   `stains_enabled`: `1` - Creates stains on surfaces from the explosion.
    *   `stains_radius`: `15` - The radius of the explosion stains.

### Visual and Effect Elements (`Entity` block within the main entity)

This nested entity contains visual and particle effects.

*   **`InheritTransformComponent`**:
    *   `Transform position.y`: `-8` - Offsets the position of these effects slightly downwards.
*   **`ParticleEmitterComponent`**:
    *   `emitted_material_name`: `spark_blue` - The type of particle emitted.
    *   `lifetime_min`/`lifetime_max`: `1`/`3` - Duration of each particle.
    *   Velocity parameters (`x_vel_min`, `x_vel_max`, `y_vel_min`, `y_vel_max`): Define the initial speed and direction of particles.
    *   `count_min`/`count_max`: `15`/`15` - Number of particles emitted per burst.
    *   `emission_interval_min_frames`/`emission_interval_max_frames`: `12`/`12` - How often particles are emitted (every 12 frames).
    *   `area_circle_radius.max`: `11` - The radius of the emission area.
    *   `is_emitting`: `1` - The emitter is active.
*   **`LightComponent`**:
    *   `radius`: `80` - The radius of the light emitted.
    *   `r`, `g`, `b`: `45`, `165`, `250` - Defines the blue color of the light.

### Worm Interaction (`WormAttractorComponent`)

This component is responsible for the deflector's primary function.

*   `direction`: `-1` - Indicates the direction of attraction (likely repelling worms).
*   `radius`: `512` - The range within which worms are affected.

### User Interface (`UIInfoComponent`)

Provides information for the game's UI.

*   `name`: `$building_worm_deflector` - The in-game name of the building.

### Scripting (`LuaComponent`)

Allows for custom scripting behavior.

*   `script_death`: `data/scripts/buildings/worm_deflector_death.lua` - The Lua script executed when the deflector dies.